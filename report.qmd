---
title: "The Relationship between Race and Wealth in U.S. history over Time"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

## Introduction

Research Question: Does a movie's passage of the Bechdel test influence its success?

This question is important as it relates to the level of female representation in the film industry, and the value that the film industry places on female actors, characters, and storylines in film.


Data Information:

This data is from fivethirtyeight.come, and was originally collected from IMBD movie data in 2017.

The observations in this datasets are various movies, and the variables include: year (year movie was released), imdb (imdb code for movie), title (title of movie), test (whether it passes each criterion of the Bechdel test- contains two named female characters, do these two women speak to each other, do they speak to each other about something other than a man), binary (whether the movie passes the Bechdel test) budget (movie budget), domgross (the domestic gross product of the movie, intgross (the international gross product of the movie), and the budget/GDP of the movies converted to 2013 dollars.

Literature:

Our research question sparked from a fivethirtyeight.com article that described how ⅓ of the top 50 movies from 2016 failed the Bechdel Test. The Bechdel Test is a simple test that assesses movies based on three criteria: does a movie have at least two named female characters? Do these named characters have at least one conversation? Is this conversation about something that is not about a man? We were surprised by the number of movies that did not pass this seemingly basic test, even in 2016. This article further explored diversity in the film industry, testing movies on whether the on-set crew were 50% women (of which none of these top 50 movies passed), and explored the racial diversity in the film industry. 

To further explore female representation and characterization in the film industry, we want to investigate the relationship between film budget and profit in regard to whether films pass the Bechdel test. 

(article: https://projects.fivethirtyeight.com/next-bechdel/)

## Methodology

```{r}
#| label: load-packages
#| message: false
library(tidyverse)
```

```{r}
#| label: load-data-wealth-and-income

bechdel<- read.csv(file = 'data/bechdel_test.csv')

```

```{r}
#| label: ella
rated_r <- bechdel |>
  filter(rated == 'R')
rated_pg13 <- bechdel |>
  filter(rated == 'PG-13')
rated_pg <- bechdel |>
  filter(rated == 'PG')
rated_g <- bechdel |>
  filter(rated == 'G')

pass_g <- rated_g |>
  filter(binary == 'PASS')
pass_pg <- rated_pg |>
  filter(binary == 'PASS')
pass_pg13 <- rated_pg13 |>
  filter(binary == 'PASS')
pass_r <- rated_r |>
  filter(binary == 'PASS')

nrow(pass_g)/ nrow(rated_g)
nrow(pass_pg)/ nrow(rated_pg)
nrow(pass_pg13)/ nrow(rated_pg13)
nrow(pass_r)/ nrow(rated_r)

bechdel_movies <- bechdel |>
  filter(type== 'movie') |>
  drop_na(rated)

bechdel_movies |>
  filter(rated != 'N/A') |>
  filter(rated != 'Not Rated') |>
  mutate(
    rating = fct_relevel(rated, 'G', 'PG', 'TV-PG', 'PG-13','TV-14', 'NC-17', 'R', 'X', 'Unrated')) |>
  ggplot(aes(x = rating, fill = binary)) +
  geom_bar(position = "fill")


```

```{r}
#| label: ella2
bechdel_rating <- bechdel |> 
  group_by(rated) |>
  summarize (n = n())
bechdel |>
  mutate(
    imdb_low = imdb_rating< 2.5,
    imdb_mid1 = between(imdb_rating, 2.5, 5.0),
    imdb_mid2 = between(imdb_rating, 5.1, 7.5),
    imdb_high = imdb_rating> 7.5,
  )
bechdel$type <- as.factor(ifelse(bechdel$imdb_rating < 2.5, 'low',
                          ifelse(bechdel$imdb_rating < 5.0, 'mid1', 
                          ifelse(bechdel$imdb_rating < 7.5, 'mid2', 
                          ifelse(bechdel$imdb_rating < 10.0, 'high',0)))))
bechdel |>
  filter(type != 'NA') |>
  ggplot(aes(x = type, fill = binary)) +
  geom_bar(position = "fill") +
  scale_x_discrete(limits = c("low", "mid1", "mid2", "high"))
  

  
```

Movies that fall withing the 2.5-5.0 ranking on IMDB are the most likely to Pass the bechdel test, while higher-ranked movies are less likely to pass than middle-ranked movies.

```{r}
#| label: point-imdb-year-binary
bechdel |>
  filter(type == 'high') |>
  ggplot(aes(x = year, y = imdb_rating, color = binary)) +
  geom_point()
```

g

```{r}
#| label: point-year-budget-binary
bechdel|>
  ggplot(aes(x = year, y = budget, color = binary )) +
  geom_point()
bechdel|>
  ggplot(aes(x = year, y = budget)) +
  geom_point() +
  facet_wrap(~binary) +
  geom_smooth(method = lm, se = FALSE)
```

```{r}
#| label: histogram-year-binary
bechdel|>
  ggplot(aes(x = year, fill = binary)) +
  geom_bar(position = "fill")
bechdel|>
  filter(year == 1970)
bechdel|>
  ggplot(aes(x = year)) +
  geom_histogram()

```

Are lower budget or higher budget movies more likely to pass?

```{r}
#| label: bar-median-budget
bechdel|>
summarize(median = median(budget))
low_budget <- bechdel |>
  filter(budget<= 2.8e+07)
high_budget <- bechdel |>
  filter(budget > 2.8e+07 )
low_budget|>
  ggplot(aes(x = budget, color = binary)) +
  geom_histogram()
high_budget |>
  ggplot(aes(x = binary)) +
  geom_bar() 

 
```

```{r}
#| label: boxplot-budget

bechdel$budg<- as.factor(ifelse(bechdel$budget<2.8e+07, "low", "high"))
bechdel|>
  ggplot(aes(x = budg, fill = binary)) +
  geom_bar(position = "fill")
bechdel|>
  ggplot(aes(x = budget)) +
  geom_boxplot()
```

Summary Statistics ideas:
