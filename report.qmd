---
title: "The Relationship between Race and Wealth in U.S. history over Time"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

## Introduction

Research Question: Does a movie's passage of the Bechdel test influence its success?

## Methodology

```{r}
#| label: load-packages
#| message: false
library(tidyverse)
```

```{r}
#| label: load-data-wealth-and-income

bechdel<- read.csv(file = 'data/bechdel_test.csv')

```

```{r}
#| label: ella
rated_r <- bechdel |>
  filter(rated == 'R')
rated_pg13 <- bechdel |>
  filter(rated == 'PG-13')
rated_pg <- bechdel |>
  filter(rated == 'PG')
rated_g <- bechdel |>
  filter(rated == 'G')

pass_g <- rated_g |>
  filter(binary == 'PASS')
pass_pg <- rated_pg |>
  filter(binary == 'PASS')
pass_pg13 <- rated_pg13 |>
  filter(binary == 'PASS')
pass_r <- rated_r |>
  filter(binary == 'PASS')

nrow(pass_g)/ nrow(rated_g)
nrow(pass_pg)/ nrow(rated_pg)
nrow(pass_pg13)/ nrow(rated_pg13)
nrow(pass_r)/ nrow(rated_r)

bechdel_movies <- bechdel |>
  filter(type== 'movie') |>
  drop_na(rated)

bechdel_movies |>
  filter(rated != 'N/A') |>
  filter(rated != 'Not Rated') |>
  mutate(
    rating = fct_relevel(rated, 'G', 'PG', 'TV-PG', 'PG-13','TV-14', 'NC-17', 'R', 'X', 'Unrated')) |>
  ggplot(aes(x = rating, fill = binary)) +
  geom_bar(position = "fill")


```

```{r}
#| label: ella2
bechdel_rating <- bechdel |> 
  group_by(rated) |>
  summarize (n = n())
bechdel |>
  mutate(
    imdb_low = imdb_rating< 2.5,
    imdb_mid1 = between(imdb_rating, 2.5, 5.0),
    imdb_mid2 = between(imdb_rating, 5.1, 7.5),
    imdb_high = imdb_rating> 7.5,
  )
bechdel$type <- as.factor(ifelse(bechdel$imdb_rating < 2.5, 'low',
                          ifelse(bechdel$imdb_rating < 5.0, 'mid1', 
                          ifelse(bechdel$imdb_rating < 7.5, 'mid2', 
                          ifelse(bechdel$imdb_rating < 10.0, 'high',0)))))
bechdel |>
  filter(type != 'NA') |>
  ggplot(aes(x = type, fill = binary)) +
  geom_bar(position = "fill") +
  scale_x_discrete(limits = c("low", "mid1", "mid2", "high"))
  

  
```

Movies that fall withing the 2.5-5.0 ranking on IMDB are the most likely to Pass the bechdel test, while higher-ranked movies are less likely to pass than middle-ranked movies.

```{r}
#| label: point-imdb-year-binary
bechdel |>
  filter(type == 'high') |>
  ggplot(aes(x = year, y = imdb_rating, color = binary)) +
  geom_point()
```

g

```{r}
#| label: point-year-budget-binary
bechdel|>
  ggplot(aes(x = year, y = budget, color = binary )) +
  geom_point()
bechdel|>
  ggplot(aes(x = year, y = budget)) +
  geom_point() +
  facet_wrap(~binary) +
  geom_smooth(method = lm, se = FALSE)
```

```{r}
#| label: histogram-year-binary
bechdel|>
  ggplot(aes(x = year, fill = binary)) +
  geom_bar(position = "fill")
bechdel|>
  filter(year == 1970)
bechdel|>
  ggplot(aes(x = year)) +
  geom_histogram()

```

Are lower budget or higher budget movies more likely to pass?

```{r}
#| label: bar-median-budget
bechdel|>
summarize(median = median(budget))
low_budget <- bechdel |>
  filter(budget<= 2.8e+07)
high_budget <- bechdel |>
  filter(budget > 2.8e+07 )
low_budget|>
  ggplot(aes(x = budget, color = binary)) +
  geom_histogram()
high_budget |>
  ggplot(aes(x = binary)) +
  geom_bar() 

 
```

```{r}
#| label: boxplot-budget

bechdel$budg<- as.factor(ifelse(bechdel$budget<2.8e+07, "low", "high"))
bechdel|>
  ggplot(aes(x = budg, fill = binary)) +
  geom_bar(position = "fill")
bechdel|>
  ggplot(aes(x = budget)) +
  geom_boxplot()
```

Summary Statistics ideas:
